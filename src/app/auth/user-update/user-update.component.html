<div class="lds-ring spin-center" *ngIf="isLoading">
  <div></div>
  <div></div>
  <div></div>
  <div></div>
</div>
<div class="main-div" *ngIf="!isLoading">
  <mat-card class="mat-elevation-z4">
    <mat-card-header
      ><mat-card-title><h2>Profile</h2></mat-card-title>
      <mat-card-subtitle>
        <p class="sub-title">
          <i class="fas fa-user fa-sm"></i>
          Update Your Details
        </p>
      </mat-card-subtitle></mat-card-header
    >
    <mat-card-content>
      <form
        #updateUserForm="ngForm"
        (ngSubmit)="onSubmit(updateUserForm.value)"
      >
        <mat-form-field class="user-name first-name" appearance="outline">
          <mat-label>First Name</mat-label>
          <input
            matInput
            name="firstName"
            ngModel
            [(ngModel)]="userDetails.firstName"
            type="text"
            #firstNameInput="ngModel"
            placeholder="First Name"
            required
          />
        </mat-form-field>
        <div
          class="first-name-error desktop-hide"
          *ngIf="
            firstNameInput.invalid &&
            (firstNameInput.dirty || firstNameInput.touched)
          "
        >
          <div *ngIf="firstNameInput.errors?.required">
            <mat-error>First Name is required!</mat-error>
          </div>
        </div>
        <br
          class="desktop-hide"
          *ngIf="
            firstNameInput.invalid &&
            (firstNameInput.dirty || firstNameInput.touched)
          "
        />
        <mat-form-field class="user-name second-name" appearance="outline">
          <mat-label>Last Name</mat-label>
          <input
            matInput
            name="lastName"
            ngModel
            [(ngModel)]="userDetails.lastName"
            type="text"
            #lastNameInput="ngModel"
            placeholder="Last Name"
            required
          />
        </mat-form-field>
        <div
          class="first-name-error mobile-hide"
          *ngIf="
            firstNameInput.invalid &&
            (firstNameInput.dirty || firstNameInput.touched)
          "
        >
          <div *ngIf="firstNameInput.errors?.required">
            <mat-error>First Name is required!</mat-error>
          </div>
        </div>
        <br
          class="mobile-hide"
          *ngIf="
            firstNameInput.invalid &&
            (firstNameInput.dirty || firstNameInput.touched)
          "
        />
        <div
          class="second-name-error"
          *ngIf="
            lastNameInput.invalid &&
            (lastNameInput.dirty || lastNameInput.touched)
          "
        >
          <div *ngIf="lastNameInput.errors?.required">
            <mat-error>Last Name is required!</mat-error>
          </div>
        </div>
        <br
          *ngIf="
            lastNameInput.invalid &&
            (lastNameInput.dirty || lastNameInput.touched)
          "
        />
        <mat-form-field appearance="outline">
          <mat-label>Email</mat-label>
          <input
            matInput
            name="email"
            ngModel
            [(ngModel)]="userDetails.email"
            type="email"
            placeholder="Email Address"
            #emailInput="ngModel"
            required
            email
          />
        </mat-form-field>
        <div
          *ngIf="emailInput.invalid && (emailInput.dirty || emailInput.touched)"
        >
          <div *ngIf="emailInput.errors?.required">
            <mat-error>Email address is required!</mat-error>
          </div>
          <div *ngIf="emailInput.errors?.email">
            <mat-error>Please enter a valid email!</mat-error>
          </div>
        </div>
        <br
          *ngIf="emailInput.invalid && (emailInput.dirty || emailInput.touched)"
        />
        <mat-form-field appearance="outline">
          <mat-label>Mobile</mat-label>
          <input
            matInput
            name="mobile"
            ngModel
            [(ngModel)]="userDetails.mobile"
            type="tel"
            placeholder="Mobile"
            #mobileInput="ngModel"
            pattern="[0-9]{10}"
            required
          />
        </mat-form-field>
        <div
          *ngIf="
            mobileInput.invalid && (mobileInput.touched || mobileInput.dirty)
          "
        >
          <div *ngIf="mobileInput.errors?.required">
            <mat-error>Mobile number is required!</mat-error>
          </div>
          <div *ngIf="mobileInput.errors?.pattern">
            <mat-error>Please enter a valid mobile number!</mat-error>
          </div>
        </div>
        <br
          *ngIf="
            mobileInput.invalid && (mobileInput.dirty || mobileInput.touched)
          "
        />
        <mat-form-field class="location-field" appearance="outline">
          <mat-label>Location</mat-label>
          <mat-select
            name="location"
            ngModel
            [(ngModel)]="userDetails.location"
            #locationInput="ngModel"
            required
          >
            <mat-option *ngFor="let location of locations" [value]="location">
              {{ location }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <div
          *ngIf="
            locationInput.invalid &&
            (locationInput.touched || locationInput.dirty)
          "
        >
          <div *ngIf="locationInput.errors?.required">
            <mat-error>Please select any one of the locations!</mat-error>
          </div>
        </div>
        <br
          *ngIf="
            locationInput.invalid &&
            (locationInput.dirty || locationInput.touched)
          "
        />
        <br />
        <button
          mat-raised-button
          type="submit"
          [disabled]="updateUserForm.invalid"
        >
          Update Changes
        </button>
      </form>
    </mat-card-content>
    <br *ngIf="updateErrors" />
    <div *ngIf="updateErrors">
      <mat-error
        >Update failed. Another user with same e-mail already exists!</mat-error
      >
    </div>
  </mat-card>
</div>
